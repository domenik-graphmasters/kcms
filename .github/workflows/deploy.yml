name: Deploy to update server
on:
    push:
        branches:
          - 'release'

env:
  FTP_SERVER: ${{ secrets.FTP_SERVER }}
  FTP_USER: ${{ secrets.FTP_USER }}
  FTP_PASSWORD: ${{ secrets.FTP_PASSWORD }}

jobs:
    build:
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v4
            
            - name: creates output
              run:  sh ./build.sh
    
            - name: Upload to server
              uses: Dylan700/sftp-upload-action@latest
              with:
                server: ${{ secrets.FTP_SERVER }}
                username: ${{ secrets.FTP_USER }}
                password: ${{ secrets.FTP_PASSWORD }}
                port: 22
                uploads: |
                  ./custom/ => ./custom/
                  ./modules/ => ./modules/
                  ./vendor/ => ./vendor/
                  ./api.php => ./api.php
                  ./index.php => ./index.php
                  ./redirect.php => ./redirect.php